const e=function(){const e="http://127.0.0.1:5000/api/locations";return{getLocations:async function(){try{const t={method:"get",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},url:e,transformResponse:[e=>e]},n=await axios(t);return JSON.parse(n.data)}catch(e){console.error(e)}}}}(),t=function(){new Date;const e=new MutationObserver((function(e){if(e.length>1){const e=document.querySelector(".row-one-two").querySelector(".block__weather__location"),c=document.createElement("div");c.className="main__date row",e.after(c),n.setNodesFunction(n.createNode(t.getClasses().btnFavIcon),n.setUserFav);const i=n.getMainLocation().timezone,s=n.getMainLocation().language;o=c,a=i,r=s,setInterval(()=>{let e=new Date,t=new Date(e.getTime()+1e3*a),n=new Intl.DateTimeFormat("it",{dateStyle:"full",timeStyle:"long",timeZone:"GMT"}).format(t),c=n.substring(n.indexOf(":")-2,n.lastIndexOf(":")+3),i=new Intl.DateTimeFormat(""+r,{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(t);const s=document.createElement("div");s.className="main__week_day col-12",s.innerHTML=i;const l=document.createElement("div");l.className="main__time col-12",l.innerHTML=c,o.innerHTML=s.outerHTML+l.outerHTML},1e3)}var o,a,r})),o={elementContainer:document.querySelector(".container__weather__blocks")},a={btnFavIcon:".btn-fav-icon"};return{getSelectors:function(){return o},getClasses:function(){return a},getObserver:function(){return e}}}(),n=function(){const o={mainLocation:0},a={fav:""};let r=[];const c=function(e,t,n,o,a,r,c,i="col-3",s="",l,m){e=e.charAt(0).toUpperCase()+e.slice(1),t=t.charAt(0).toUpperCase()+t.slice(1),a=a.charAt(0).toUpperCase()+a.slice(1);const u=document.createElement("div");u.className=`block__weather ${i} ${s}`;const d=document.createElement("h4");d.className="block__weather__first__name row-5",d.innerHTML=`<div class="col-1"></div><div class='col-3'>${e}</div><div class="col-1"> <button data-user-code=${m} class="btn-fav-icon"><i class="fas fa-home "></i></button> </div>`;const p=document.createElement("h4");p.className="block__weather__location",p.innerHTML=""+t;const f=document.createElement("img");f.className="block__weather__icon",f.src=`http://openweathermap.org/img/wn/${o}@2x.png`;const h=document.createElement("h4");h.className="block__weather__main",h.innerHTML=""+a;const g=document.createElement("h4");g.className="block__weather__temp",g.innerHTML=`<i class="fas fa-thermometer-half"></i> ${r} Â°`;const v=document.createElement("h4");return v.className="block__weather__wind",v.innerHTML=`<i class="fas fa-wind"></i> ${c} km/h`,u.innerHTML+=d.outerHTML+p.outerHTML+f.outerHTML+h.outerHTML+g.outerHTML+v.outerHTML,{html:u,position:l}};return{getUserFav:function(){return a},arrAllUsers:function(){e.getLocations().then((e,t)=>{if(e)return console.log("resolved"),r=e,e;console.log("not resolved")}).then(e=>((e=>{for(let t=e.length-1;t>0;t--){let n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}})(e),e)).then(e=>{if(""===n.getUserFav().fav){console.log("set main");let t=e.findIndex(e=>!0===e.mainLocation);o.mainLocation=e[t],e.splice(t,1)}if(""!==n.getUserFav().fav){let t=n.getUserFav().fav,a=e.findIndex(e=>e.userCode===Number(t)),r=e.find(e=>e.userCode===Number(t));o.mainLocation=r,e.splice(a,1)}return e}).then(e=>{((e,t)=>{let n=[];for(let o=0;o<t-1;o=o+t-1)n.push(e.slice(o,o+t-1));let o=e.splice(t-1,e.length);return[...n,o]})(e,5).map(async(e,n)=>{if(0===n){e.splice(1,0,o.mainLocation);const n=document.createElement("div");n.className="row row-double";let a=[];e.map(async(o,r)=>{const i=c(o.firstName,o.location,o.language,o.icon,o.description,o.temperature,o.wind,1===r?"col-6 t-center-x":"col-3 t-center-x",1===r?"row-one-two":r>=3?"row-two":"row-one",o.position,o.userCode);a.push(i),a.length===e.length&&(a.sort((e,t)=>e.position-t.position),a.map((e,o)=>{let a=e.html;n.innerHTML+=a.outerHTML,t.getSelectors().elementContainer.appendChild(n)}))})}else n>0&&((e,t)=>{for(var n=[];e.length;)n.push(e.splice(0,t));return n})(e,4).map(e=>{if(1===e.length){const n=document.createElement("div");n.className="row pv-1",e.map((e,o)=>{const a=c(e.firstName,e.location,e.language,e.icon,e.description,e.temperature,e.wind,"col-6 t-center-x","",e.position,e.userCode);n.innerHTML+="<div class='col-3'></div>",n.appendChild(a.html),t.getSelectors().elementContainer.appendChild(n)})}else if(2===e.length){const n=document.createElement("div");n.className="row pv-1",e.map((e,o)=>{const a=c(e.firstName,e.location,e.language,e.icon,e.description,e.temperature,e.wind,col6,"",e.position,e.userCode);n.appendChild(a.html),t.getSelectors().elementContainer.appendChild(n)})}else if(3===e.length){const n=document.createElement("div");n.className="row pv-1",e.map((e,o)=>{const a=c(e.firstName,e.location,e.language,e.icon,e.description,e.temperature,e.wind,"col-4 t-center-x","",e.position,e.userCode);n.appendChild(a.html),t.getSelectors().elementContainer.appendChild(n)})}else{const n=document.createElement("div");n.className="row pv-1",e.map((e,o)=>{const a=c(e.firstName,e.location,e.language,e.icon,e.description,e.temperature,e.wind,"col-3 t-center-x","",e.position,e.userCode);n.appendChild(a.html),t.getSelectors().elementContainer.appendChild(n)})}})})})},createNode:function(e){return document.querySelectorAll(e)},setNodesFunction:function(e,t){e.forEach(e=>{e.addEventListener("click",t)})},setUserFav:function(e){let t=e.target.parentElement.getAttribute("data-user-code");n.getUserFav().fav=t,localStorage.setItem("userFav",n.getUserFav().fav),location.reload()},getMainLocation:function(){return o.mainLocation}}}(),o=function(e,t,n){return{init:function(){!function(){n.arrAllUsers();t.getObserver().observe(t.getSelectors().elementContainer,{attributes:!0,childList:!0,characterData:!0})}(),function(){let e=localStorage.getItem("userFav");if(e)n.getUserFav().fav=e}()}}}(0,t,n);o.init();